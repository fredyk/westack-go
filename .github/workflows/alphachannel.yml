# on push to any branch that is not alpha, create a pull request to merge the branch into alpha
name: Alpha Channel

on:
  push:
    branches-ignore:
      - alpha
#      - update-dependency-* # ignore branches created by the update-dependencies workflow

jobs:

    alpha:
        runs-on: ubuntu-latest
        env:
          GITHUB_TOKEN: ${{ secrets.PULL_REQUEST_TOKEN }}
        steps:
        - name: Checkout
          uses: actions/checkout@v3

#        - name: Create Pull Request Using Action
#          uses: peter-evans/create-pull-request@v3
#          with:
#              token: ${{ secrets.PULL_REQUEST_TOKEN }}
#              commit-message: Merge ${{ github.ref }} into alpha
#              title: Merge ${{ github.ref }} into alpha
#              body: |
#                Merge ${{ github.ref }} into alpha
#              branch: ${{ github.ref }}
#              base: alpha
#              labels: |
#                auto-merge
#                auto-merge-squash

        - name: Create Pull Request Using REST API
          run: |
            curl \
              -X POST \
              -H "Accept: application/vnd.github.v3+json" \
              -H "Authorization: token ${{ secrets.PULL_REQUEST_TOKEN }}" \
              https://api.github.com/repos/${{ github.repository }}/pulls \
              -d '{"title":"Merge ${{ github.ref }} into alpha","body":"Merge ${{ github.ref }} into alpha","head":"${{ github.ref }}","base":"alpha","labels":["auto-merge","auto-merge-squash"]}' || true